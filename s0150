#!/bin/bash

<<COMMENT
Starting with this:

x: 1
z: 2

insert p:3 after x

x: 1
p: 3
z: 2
COMMENT

cat >o1.yaml <<'EOF'
x: 1
z: 2
EOF

cue import --force --outfile o1.cue o1.yaml

cat >update.cue <<'EOF'
import "list"

// Maintain original field order while inserting new field
// First field - keep original x value
@list(order,10)
x: _

// Insert new field between x and z
@list(order,20)
p: 3

// Last field - keep original z value
@list(order,30)
z: _
EOF

cue eval --force --concrete o1.cue update.cue --out yaml --outfile=o1.yaml
cat o1.yaml
